#!/bin/bash

# lbnebuild
#
# David Adams
# July 2014
#
# Build the checked-out code.

# LBNE setup.
source $LBNE_INSDIR/lbneinit.sh

cd $LBNE_DEVDIR/workdir

echo $LBNE_LINE
echo Setting up $LBNE_PROJECT
setup $LBNE_PROJECT $LBNE_PROJECTVERSION -q $LBNE_QUAL

echo $LBNE_LINE
echo Setting up $LBNE_PRODUCT
source localProducts_$LBNE_PRODUCT/setup

echo $LBNE_LINE
cd $MRB_BUILDDIR
echo Building in `pwd`
if [ -n "$LBNE_VERBOSE" ]; then echo Running mrbsetenv; fi
mrbsetenv
if [ -n "$LBNE_VERBOSE" ]; then echo Running $COM; fi
COM="mrb i -j4"
if [ -n "$LBNE_VERBOSE" ]; then echo Running $COM; fi
$COM 
echo "$COM" >> $LBNE_HISTORY

echo Set up to run
if [ -n "$LBNE_VERBOSE" ]; then echo Running mrbslp; fi
mrbslp
cd $THISDIR

if [ -n "$LBNE_VERBOSE" ]; then echo exiting lbnebuild; fi
